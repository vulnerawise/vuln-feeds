{
  "metadata": {
    "timestamp": "2025-02-23T02:47:40Z"
  },
  "data": [
    {
      "cve": {
        "id": "CVE-2022-33891",
        "description": "The Apache Spark UI offers the possibility to enable ACLs via the configuration option spark.acls.enable. With an authentication filter, this checks whether a user has access permissions to view or modify the application. If ACLs are enabled, a code path in HttpSecurityFilter can allow someone to perform impersonation by providing an arbitrary user name. A malicious user might then be able to reach a permission check function that will ultimately build a Unix shell command based on their input, and execute it. This will result in arbitrary shell command execution as the user Spark is currently running as. This affects Apache Spark versions 3.0.3 and earlier, versions 3.1.1 to 3.1.2, and versions 3.2.0 to 3.2.1.",
        "metadata": {
          "published_date": "2022-07-18T07:15:07.600",
          "last_modified_date": "2025-02-04T15:15:15.563",
          "confidence_level": "high",
          "severity": "high"
        },
        "impact": {
          "cisa_kev": true,
          "reported_exploited": true,
          "exploit_maturity": "active",
          "automatable": false
        },
        "counts": {
          "public_exploit_count": 19
        },
        "epss": {
          "score": 0.97286,
          "percentile": 0.99934
        },
        "metrics": [
          {
            "source": "nvd@nist.gov",
            "type": "Primary",
            "cvss_version": "3.1",
            "vector_string": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
            "attack_vector": "NETWORK",
            "base_score": 8.80000019073486
          },
          {
            "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
            "type": "Secondary",
            "cvss_version": "3.1",
            "vector_string": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
            "attack_vector": "NETWORK",
            "base_score": 8.80000019073486
          }
        ],
        "timeline": {
          "references": [
            {
              "type": "reference",
              "url": "http://packetstormsecurity.com/files/168309/Apache-Spark-Unauthenticated-Command-Injection.html",
              "source_type": "poc",
              "source": "nvd",
              "description": "",
              "published": "2022-07-18T05:00:00.000Z"
            },
            {
              "type": "reference",
              "url": "http://packetstormsecurity.com/files/168309/Apache-Spark-Unauthenticated-Command-Injection.html",
              "source_type": "poc",
              "source": "nvd",
              "description": "",
              "published": "2022-07-18T05:00:00.000Z"
            },
            {
              "type": "reference",
              "url": "https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json#CVE-2022-33891",
              "source_type": "exploited",
              "source": "cisa",
              "description": "Apache Spark contains a command injection vulnerability via Spark User Interface (UI) when Access Control Lists (ACLs) are enabled.. knownRansomwareCampaignUse = Unknown",
              "published": "2023-03-07"
            },
            {
              "type": "reference",
              "url": "https://0day.today/exploit/description/37945",
              "source_type": "poc",
              "source": "0day",
              "description": "Apache Spark Unauthenticated Command Injection Exploit",
              "published": "2022-09-08T05:00:00.000Z"
            },
            {
              "type": "reference",
              "url": "https://packetstormsecurity.com/files/download/168309/apache_spark_rce_cve_2022_33891.rb.txt",
              "source_type": "poc",
              "source": "packetstorm",
              "description": "Apache Spark Unauthenticated Command Injection",
              "published": "2022-09-08T05:00:00.000Z"
            },
            {
              "type": "reference",
              "url": "https://github.com/projectdiscovery/nuclei-templates/blob/main/http/cves/2022/CVE-2022-33891.yaml",
              "source_type": "weapon",
              "source": "nuclei",
              "description": "Apache Spark UI - Remote Command Injection",
              "published": "2022-07-19T05:00:00.000Z"
            },
            {
              "type": "reference",
              "url": "https://github.com/rapid7/metasploit-framework/blob/master//modules/exploits/linux/http/apache_spark_rce_cve_2022_33891.rb",
              "source_type": "weapon",
              "source": "metasploit",
              "description": "Apache Spark Unauthenticated Command Injection RCE",
              "published": "2022-07-18T05:00:00.000Z"
            }
          ],
          "repositories": [
            {
              "type": "repository",
              "url": "https://github.com/W01fh4cker/cve-2022-33891",
              "description": "cve-2022-33891-poc",
              "published": "2022-07-20T08:00:18Z",
              "created": "2022-07-18T16:16:51Z",
              "last_modified": "2024-08-12T20:25:12Z",
              "repo_name": "W01fh4cker/cve-2022-33891",
              "name": "",
              "stars": 52,
              "forks": 22
            },
            {
              "type": "repository",
              "url": "https://github.com/HuskyHacks/cve-2022-33891",
              "description": "Apache Spark Shell Command Injection Vulnerability",
              "published": "2022-09-07T18:12:27Z",
              "created": "2022-07-19T18:52:12Z",
              "last_modified": "2025-01-22T23:29:01Z",
              "repo_name": "HuskyHacks/cve-2022-33891",
              "name": "",
              "stars": 88,
              "forks": 20
            },
            {
              "type": "repository",
              "url": "https://github.com/AmoloHT/CVE-2022-33891",
              "description": "„Äåüí•„ÄçCVE-2022-33891 - Apache Spark Command Injection",
              "published": "2022-08-01T21:30:09Z",
              "created": "2022-07-30T23:02:16Z",
              "last_modified": "2025-02-14T17:11:12Z",
              "repo_name": "AmoloHT/CVE-2022-33891",
              "name": "",
              "stars": 26,
              "forks": 6
            },
            {
              "type": "repository",
              "url": "https://github.com/nanaao/CVE-2022-33891",
              "description": "PoC for CVE-2022-33891",
              "published": "2022-07-19T23:20:14Z",
              "created": "2022-07-20T05:15:28Z",
              "last_modified": "2022-07-20T05:15:24Z",
              "repo_name": "nanaao/CVE-2022-33891",
              "name": "",
              "stars": 0,
              "forks": 7
            },
            {
              "type": "repository",
              "url": "https://github.com/AkbarTrilaksana/cve-2022-33891",
              "description": "",
              "published": "2024-06-18T14:07:23Z",
              "created": "2022-07-20T22:52:43Z",
              "last_modified": "2022-09-19T13:06:15Z",
              "repo_name": "AkbarTrilaksana/cve-2022-33891",
              "name": "",
              "stars": 3,
              "forks": 1
            },
            {
              "type": "repository",
              "url": "https://github.com/llraudseppll/cve-2022-33891",
              "description": "Apache Spark RCE",
              "published": "2022-07-24T07:48:41Z",
              "created": "2022-07-24T07:45:46Z",
              "last_modified": "2024-08-12T20:25:24Z",
              "repo_name": "llraudseppll/cve-2022-33891",
              "name": "",
              "stars": 1,
              "forks": 1
            },
            {
              "type": "repository",
              "url": "https://github.com/DrLinuxOfficial/CVE-2022-33891",
              "description": "CVE-2022-33891 Exploit For Apache Spark",
              "published": "2022-08-13T23:07:12Z",
              "created": "2022-08-13T23:02:56Z",
              "last_modified": "2022-08-15T02:26:44Z",
              "repo_name": "DrLinuxOfficial/CVE-2022-33891",
              "name": "",
              "stars": 1,
              "forks": 1
            },
            {
              "type": "repository",
              "url": "https://github.com/Vulnmachines/Apache-spark-CVE-2022-33891",
              "description": "Apache Spark RCE - CVE-2022-33891",
              "published": "2022-08-30T12:03:50Z",
              "created": "2022-08-29T08:48:38Z",
              "last_modified": "2022-08-31T08:16:54Z",
              "repo_name": "Vulnmachines/Apache-spark-CVE-2022-33891",
              "name": "",
              "stars": 1,
              "forks": 0
            },
            {
              "type": "repository",
              "url": "https://github.com/ps-interactive/lab_security_apache_spark_emulation_detection",
              "description": "For CVE-2022-33891 Apache Spark: Emulation and Detection by West Shepherd",
              "published": "2024-08-19T21:35:00Z",
              "created": "2022-12-06T23:44:30Z",
              "last_modified": "2024-08-19T21:35:03Z",
              "repo_name": "ps-interactive/lab_security_apache_spark_emulation_detection",
              "name": "",
              "stars": 0,
              "forks": 0
            },
            {
              "type": "repository",
              "url": "https://github.com/elsvital/cve-2022-33891-fix",
              "description": "",
              "published": "2023-11-26T13:52:57Z",
              "created": "2023-11-26T13:09:28Z",
              "last_modified": "2023-11-26T13:47:47Z",
              "repo_name": "elsvital/cve-2022-33891-fix",
              "name": "",
              "stars": 0,
              "forks": 0
            },
            {
              "type": "repository",
              "url": "https://github.com/K3ysTr0K3R/CVE-2022-33891-EXPLOIT",
              "description": "A PoC exploit for CVE-2022-33891 - Apache Spark UI Remote Code Execution (RCE)",
              "published": "2024-02-22T16:19:49Z",
              "created": "2024-02-22T15:05:00Z",
              "last_modified": "2024-08-03T02:02:52Z",
              "repo_name": "K3ysTr0K3R/CVE-2022-33891-EXPLOIT",
              "name": "",
              "stars": 1,
              "forks": 0
            },
            {
              "type": "repository",
              "url": "https://github.com/asepsaepdin/CVE-2022-33891",
              "description": "",
              "published": "2025-01-30T17:18:34Z",
              "created": "2025-01-30T17:05:01Z",
              "last_modified": "2025-01-30T17:18:37Z",
              "repo_name": "asepsaepdin/CVE-2022-33891",
              "name": "",
              "stars": 0,
              "forks": 0
            }
          ]
        }
      }
    }
  ]
}